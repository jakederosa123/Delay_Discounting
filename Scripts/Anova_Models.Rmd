---
title: "Gam Analysis"
author: "Jacob DeRosa"
date: "7/7/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

library(dplyr)
library(mgcv)
library(itsadug)
library(ggplot2)
```

Factor 1: High Reward 
Factor : Snack 
Factor 3: Small/Medium Reward 
```{r}

df = read.csv("/Users/jacob.derosa/Desktop/Scripts/temp_disc_df.csv", header = T, sep = ",") %>% mutate(Sex = ifelse(Sex == 1, "Female", "Male")) %>% mutate(Sex = as.factor(Sex))

df$Agesq <-(df$Ages*df$Ages)

## Run age only models 
nullTC1model=(lm(TC1 ~ 1, data=df))
linTC1model=(lm(TC1 ~ Ages, data=df))
gamTC1model=(gam(TC1 ~ s(Ages, k=3, bs="ts"), method = "ML",data=df))
agepredictTC1table<-anova(nullTC1model,linTC1model,gamTC1model)
agepredictTC1table2<-anova(linTC1model,gamTC1model)

```

# ADHD Combined
```{r}

adhd_combined_nt <- df %>%
  filter(ADHD_C_NA == 1 | NT == 1) %>%
  mutate(Group = ifelse(ADHD_C_NA == 1, "ADHD Combined", 
                        ifelse(NT == 1, "Neurotypical", NA))) %>%
  mutate(Group = as.factor(Group)) %>%
  mutate(Group_Sex = as.factor(interaction(Group, Sex)))

ivnames = names(adhd_combined_nt)[22:26]

model <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group, list(i = as.name(x))), data = adhd_combined_nt)})
sapply(model, car::Anova,simplify =  F)

model_sex <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex, list(i = as.name(x))), data = adhd_combined_nt)})
sapply(model_sex, car::Anova,simplify =  F)

model_sex_age <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex*Ages, list(i = as.name(x))), data = adhd_combined_nt)})
sapply(model_sex_age, car::Anova,simplify =  F)

```

# ADHD Innatentive 
```{r}

adhd_inatentive_nt <- df %>%
  filter(ADHD_I_NA == 1 | NT == 1) %>%
  mutate(Group = ifelse(ADHD_I_NA == 1, "ADHD Inattentive", 
                        ifelse(NT == 1, "Neurotypical", NA))) %>%
  mutate(Group = as.factor(Group)) %>%
  mutate(Group_Sex = as.factor(interaction(Group, Sex)))

ivnames = names(adhd_inatentive_nt)[22:26]

model <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group, list(i = as.name(x))), data = adhd_inatentive_nt)})
sapply(model, car::Anova,simplify =  F)

model_sex <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex, list(i = as.name(x))), data = adhd_inatentive_nt)})
sapply(model_sex, car::Anova,simplify =  F)

model_sex_age <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex*Ages, list(i = as.name(x))), data = adhd_inatentive_nt)})
sapply(model_sex_age, car::Anova,simplify =  F)

```

# Anxiety 
```{r}

anxiety_nt <- df %>%
  filter(ANX == 1 | NT == 1) %>%
  mutate(Group = ifelse(ANX == 1, "Anxiety", 
                        ifelse(NT == 1, "Neurotypical", NA))) %>%
  mutate(Group = as.factor(Group)) %>%
  mutate(Group_Sex = as.factor(interaction(Group, Sex)))


ivnames = names(anxiety_nt)[22:26]

model <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group, list(i = as.name(x))), data = anxiety_nt)})
sapply(model, car::Anova,simplify =  F)

model_sex <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex, list(i = as.name(x))), data = anxiety_nt)})
sapply(model_sex, car::Anova,simplify =  F)

model_sex_age <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex*Ages, list(i = as.name(x))), data = anxiety_nt)})
sapply(model_sex_age, car::Anova,simplify =  F)

```

# Autism with ADHD 
```{r}

autism_nt <- df %>%
  filter(ASD == 1 & ADHD !=1 | NT == 1) %>%
  mutate(Group = ifelse(ASD == 1 & ADHD !=1, "ASD without ADHD", 
                        ifelse(NT == 1, "Neurotypical", NA))) %>%
  mutate(Group = as.factor(Group)) %>%
  mutate(Group_Sex = as.factor(interaction(Group, Sex)))

ivnames = names(autism_nt)[22:26]

model <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group, list(i = as.name(x))), data = autism_nt)})
sapply(model, car::Anova,simplify =  F)

model_sex <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex, list(i = as.name(x))), data = autism_nt)})
sapply(model_sex, car::Anova,simplify =  F)

model_sex_age <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex*Ages, list(i = as.name(x))), data = autism_nt)})
sapply(model_sex_age, car::Anova,simplify =  F)

```

# Austism with ADHD 
```{r}

autism_adhd_nt <- df %>%
  filter(ASD == 1 & ADHD == 1 | NT == 1) %>%
  mutate(Group = ifelse(ASD == 1 & ADHD == 1, "ASD with ADHD", 
                        ifelse(NT == 1, "Neurotypical", NA))) %>%
  mutate(Group = as.factor(Group)) %>%
  mutate(Group_Sex = as.factor(interaction(Group, Sex)))

ivnames = names(autism_adhd_nt)[22:26]

model <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group, list(i = as.name(x))), data = autism_adhd_nt)})
sapply(model, car::Anova,simplify =  F)

model_sex <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex, list(i = as.name(x))), data = autism_adhd_nt)})
sapply(model_sex, car::Anova,simplify =  F)

model_sex_age <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex*Ages, list(i = as.name(x))), data = autism_adhd_nt)})
sapply(model_sex_age, car::Anova,simplify =  F)


```

# Depression 
```{r}

depression_nt <- df %>%
  filter(DEP == 1 | NT == 1) %>%
  mutate(Group = ifelse(DEP == 1, "Depression", 
                        ifelse(NT == 1, "Neurotypical", NA))) %>%
  mutate(Group = as.factor(Group)) %>%
  mutate(Group_Sex = as.factor(interaction(Group, Sex)))

ivnames = names(depression_nt)[22:26]

model <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group, list(i = as.name(x))), data = depression_nt)})
sapply(model, car::Anova,simplify =  F)

model_sex <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex, list(i = as.name(x))), data = depression_nt)})
sapply(model_sex, car::Anova,simplify =  F)

model_sex_age <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex*Ages, list(i = as.name(x))), data = depression_nt)})
sapply(model_sex_age, car::Anova,simplify =  F)

```

# Learning Disorders 
```{r}

learning_nt <- df %>%
  filter(LD == 1 | NT == 1) %>%
  mutate(Group = ifelse(LD == 1, "Learning Disorder", 
                        ifelse(NT == 1, "Neurotypical", NA))) %>%
  mutate(Group = as.factor(Group)) %>%
  mutate(Group_Sex = as.factor(interaction(Group, Sex)))

ivnames = names(learning_nt)[22:26]

model <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group, list(i = as.name(x))), data = learning_nt)})
sapply(model, car::Anova,simplify =  F)

model_sex <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex, list(i = as.name(x))), data = learning_nt)})
sapply(model_sex, car::Anova,simplify =  F)

model_sex_age <- lapply(ivnames, function(x) {
  lm(substitute(i ~ Group*Sex*Ages, list(i = as.name(x))), data = learning_nt)})
sapply(model_sex_age, car::Anova,simplify =  F)

```


```{r}

cbcl <- read.csv("/Users/jacob.derosa/Documents/Github/Delay_Discounting/Data/CBCL_Cluster_df.csv") %>% select(URSI, cluster) %>% mutate(cluster = factor(cluster)) %>% inner_join(df)
ivnames = names(cbcl)[23:27]

model <- lapply(ivnames, function(x) {
  lm(substitute(i ~ cluster, list(i = as.name(x))), data = cbcl)})
sapply(model, car::Anova,simplify =  F)

model_sex <- lapply(ivnames, function(x) {
  lm(substitute(i ~ cluster*Sex, list(i = as.name(x))), data =cbcl)})
sapply(model_sex, car::Anova,simplify =  F)

model_sex_age <- lapply(ivnames, function(x) {
  lm(substitute(i ~ cluster*Sex*Ages, list(i = as.name(x))), data = cbcl)})
sapply(model_sex_age, car::Anova,simplify =  F)


```


```{r}

fc_df = read.csv("/Users/jacob.derosa/Documents/Github/Delay_Discounting/Data/FC_Cluster_df.csv", header = T, sep =",") %>% mutate(cluster = factor(cluster)) %>% mutate(Sex = factor(Sex))

ivnames = names(fc_df)[14:18]

model <- lapply(ivnames, function(x) {
  lm(substitute(i ~ cluster, list(i = as.name(x))), data = fc_df)})
sapply(model, car::Anova,simplify =  F)

model_sex <- lapply(ivnames, function(x) {
  lm(substitute(i ~ cluster*Sex, list(i = as.name(x))), data = fc_df)})
sapply(model_sex, car::Anova,simplify =  F)

model_sex_age <- lapply(ivnames, function(x) {
  lm(substitute(i ~ cluster*Sex*Ages, list(i = as.name(x))), data = fc_df)})
sapply(model_sex_age, car::Anova,simplify =  F)



```



